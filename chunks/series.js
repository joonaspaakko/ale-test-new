(self.webpackChunk=self.webpackChunk||[]).push([[148],{4731:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o}),s(2327),s(8010),s(1013),s(9217);var i=s(9928),n=s(5611);const r={name:"aleSeries",components:{aleSearch:s(4339).Z,lazy:n.Z},mixins:[i.Z],data:function(){return{collectionSource:"pageCollection",pageTitle:"Series",pageSubTitle:null,listReady:!1}},methods:{makeCollection:function(){var e=this,t=[],s=1,i=this.$store.state.library.series;_.eachRight(e.subPageSource.collection,(function(n){n.series&&_.each(n.series,(function(r){var o,a,l,u=_.find(t,{asin:r.asin}),c=!!i&&_.find(i,{asin:r.asin});if(u)u.books.push(n.title||n.shortTitle),e.subPageSource.library&&(u.minRating=_.min([u.minRating,n.myRating].map(_.toNumber).filter((function(e){return!_.isNaN(e)}))),u.allBooksMinusDupes=c.allBooksMinusDupes,u.missingLatest=l!==a);else{c.allBooksMinusDupes=e.removeDuplicates(c.allBooks),e.subPageSource.library&&(o=c.allBooksMinusDupes.filter((function(e){return c.books.some((function(t){return t===e.asin}))})),a=_.max(c.allBooksMinusDupes.map((function(e){return _.toNumber(e.bookNumbers)}))),l=_.max(o.map((function(e){return _.toNumber(e.bookNumbers)}))));var p={name:r.name,asin:r.asin,added:s,books:[n.title||n.shortTitle]};e.subPageSource.library&&c?(++s,p.minRating=_.toNumber(n.myRating),p.allBooksMinusDupes=c.allBooksMinusDupes,p.missingLatest=l!==a,t.push(p)):e.subPageSource.wishlist&&(++s,t.push(p))}}))})),_.reverse(t),this.$store.commit("prop",{key:"pageCollection",value:t}),this.updateListRenderingOptions(),this.listReady=!0},updateListRenderingOptions:function(){var e,t,s=this,i={scope:[{active:!0,key:"name",tippy:"Search narrators by name"},{active:!0,key:"books",tippy:"Search narrators by book titles"}],filter:[{excludeFromWishlist:!0,active:!1,type:"filterExtras",label:"Number of books",key:"inSeries",range:[1,(e=_.get(s.$store.state,s.collectionSource),t=_.maxBy(e,(function(e){if(e.books)return e.books.length})),t?t.books.length:1)],rangeMinDist:0,rangeSuffix:"",rangeMin:function(){return 1},rangeMax:function(){var e=_.get(s.$store.state,s.collectionSource),t=_.maxBy(e,(function(e){if(e.books)return e.books.length}));return t?t.books.length:1},condition:function(e){if(e.books){var t=this.range[0],s=this.range[1];return e.books.length>=t&&e.books.length<=s}}},{type:"divider",key:"divider1.0"},{excludeFromWishlist:!0,active:!1,type:"filterExtras",label:"Rating (min)",tippy:"Based on the book you rated lowest in the series",key:"min-rating",condition:function(e){return(e.minRating||0)>=this.range[0]},range:!0,rangeMin:function(){return 1},rangeMax:function(){return 5},rangeMinDist:0,rangeSuffix:"",tooltipFormatter:function(e){switch(e){case 1:return e+" (Not for me)";case 2:return e+" (It’s okay)";case 3:return e+" (Pretty good)";case 4:return e+" (It’s great)";case 5:return e+" (I love it)"}}},{type:"divider",key:"divider1.1"},{excludeFromWishlist:!0,active:!1,type:"filterExtras",label:"Incomplete",key:"series-incomplete",tippy:"Series where you don't have all the books",condition:function(e){return e.allBooksMinusDupes.length>e.books.length}},{type:"divider",key:"divider1.2"},{excludeFromWishlist:!0,active:!1,type:"filterExtras",label:"Missing latest",key:"missing-latest",tippy:"Series where you are missing the latest book",condition:function(e){return e.missingLatest&&e.allBooksMinusDupes.length>e.books.length}}],sort:[{active:!1,key:"randomize",label:"Randomize",type:"sortExtras",tippy:"Ignores sorting and randomizes instead unless there's an active search."},{type:"divider",key:"divider1"},{active:!0,current:!0,key:"added",label:"Added",type:"sort",tippy:'<div style="text-align: left;"><small>&#9650;</small> Old at the top <br><small style="display: inline-block; transform: rotate(180deg);">&#9650;</small> New at the top</div>'},{active:!0,current:!1,key:"name",label:"Name",type:"sort",tippy:"Sort by series name"},{active:!1,current:!1,key:"amount",label:"Number of owned books",type:"sort"},{active:!1,current:!1,key:"amountTotal",label:"Total number of books in the series",type:"sort"},{excludeFromWishlist:!0,active:!1,current:!1,key:"missing",label:"Missing",tippy:"Sort by the number of books you are missing in the series",type:"sort"}]};this.subPageSource.wishlist&&(i.filter=_.filter(i.filter,(function(e){return!e.excludeFromWishlist})),i.sort=_.filter(i.sort,(function(e){return!e.excludeFromWishlist}))),this.$setListRenderingOpts(i)},removeDuplicates:function(e){var t=_.clone(e),s=0;return _.each(t,(function(e){e.order=++s})),t=_.groupBy(t,"bookNumbers"),_.each(t,(function(e,s){if(1===e.length)t[s]=[e[0]];else{var i=_.filter(e,(function(e){return!e.notInLibrary}));i.length>0?t[s]=i:t[s]=[e[0]]}})),t=_.map(t,(function(e){return e})),t=_.flatten(t),t=_.orderBy(t,"order","asc")}}},o=(0,s(810).Z)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.$store.state.pageCollection&&e.$store.state.pageCollection.length&&e.listReady?s("div",{staticClass:"box-layout-wrapper",attrs:{id:"ale-series"}},[s("ale-search",{attrs:{collectionSource:e.collectionSource,pageTitle:e.pageTitle,pageSubTitle:e.pageSubTitle}}),e._v(" "),e._l(e.$store.getters.collection,(function(t,i){return t.asin?s("lazy",{key:"series:"+t.asin,staticClass:"single-box",attrs:{"data-asin":t.asin}},[s("router-link",{attrs:{to:{name:"series",params:{series:t.asin},query:{subPageSource:e.subPageSource.name}}}},[s("h2",[e._v(e._s(t.name))]),e._v(" "),t.books&&t.books.length?s("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"right"},expression:"{ placement: 'right' }"}],staticClass:"books-total",attrs:{content:"Total number of books I have in this series."}},[s("span",{class:{"my-books":t.allBooksMinusDupes&&t.allBooksMinusDupes.length}},[e._v(e._s(t.books.length))]),t.allBooksMinusDupes&&t.allBooksMinusDupes.length?s("span",[e._v(" of "+e._s(t.allBooksMinusDupes.length))]):e._e()]):e._e()])],1):e._e()}))],2):e._e()}),[],!1,null,"aea288e6",null).exports},5611:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});const i={name:"lazy",props:["row","tag"],data:function(){return{observer:null,intersected:!1}},mounted:function(){this.$nextTick((function(){var e=this;this.observer=new IntersectionObserver((function(t){t[0].isIntersecting&&(e.intersected=!0,e.observer.disconnect())}),{threshold:0,rootMargin:"100px"}),this.observer.observe(this.$el)}))},destroyed:function(){this.observer&&this.observer.disconnect()}},n=(0,s(810).Z)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.tag?"td"===e.tag?s("td",{class:{mounted:e.intersected}},[e.intersected?e._t("default"):e._e()],2):e._e():s("div",{class:{mounted:e.intersected}},[e.intersected?e._t("default"):e._e()],2)}),[],!1,null,null,null).exports}}]);