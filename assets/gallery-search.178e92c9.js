import{c as _t,V as wt,f as Lt,g as $t}from"./gallery.86cc5f8a.js";import{o as p,c as m,a as g,e as k,aE as Fe,h as tt,g as S,F as x,j as Y,q as W,br as ze,x as He,t as U,a6 as X,av as ye,K as z,C as w,L as ee,E as Le,aL as at,_ as Ce,r as st,b as Ge,w as me,u as Ct,d as J,n as je,i as $e,v as Tt}from"./lodash.1321b47a.js";import{_ as It}from"./gallery-findSubPageSource.65b5640c.js";import{_ as Bt}from"./gallery-page-title.868399a9.js";import{t as nt,F as Pt}from"./gallery-timeStringToSeconds.35bf7b04.js";const Et={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Nt=g("path",{fill:"currentColor",d:"M3 5v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2z"},null,-1),Rt=[Nt];function qt(e,s){return p(),m("svg",Et,Rt)}var At={name:"ic-round-square",render:qt};const Dt={viewBox:"0 0 512 512",width:"1.2em",height:"1.2em"},Mt=g("path",{fill:"currentColor",d:"M256 56c110.532 0 200 89.451 200 200c0 110.532-89.451 200-200 200c-110.532 0-200-89.451-200-200c0-110.532 89.451-200 200-200m0-48C119.033 8 8 119.033 8 256s111.033 248 248 248s248-111.033 248-248S392.967 8 256 8zm0 168c-44.183 0-80 35.817-80 80s35.817 80 80 80s80-35.817 80-80s-35.817-80-80-80z"},null,-1),Kt=[Mt];function Vt(e,s){return p(),m("svg",Dt,Kt)}var Ft={name:"fa-regular-dot-circle",render:Vt};const jt={viewBox:"0 0 512 512",width:"1.2em",height:"1.2em"},zt=g("path",{fill:"currentColor",d:"M256 8C119 8 8 119 8 256s111 248 248 248s248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200s-89.5 200-200 200z"},null,-1),Ht=[zt];function Gt(e,s){return p(),m("svg",jt,Ht)}var Wt={name:"fa-regular-circle",render:Gt};const Ut={viewBox:"0 0 320 512",width:"1.2em",height:"1.2em"},Qt=g("path",{fill:"currentColor",d:"M182.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9S19 224.1 32 224.1h256c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),Zt=[Qt];function Jt(e,s){return p(),m("svg",Ut,Zt)}var xt={name:"fa6-solid-sort-up",render:Jt};const Xt={viewBox:"0 0 320 512",width:"1.2em",height:"1.2em"},Yt=g("path",{fill:"currentColor",d:"M182.6 470.6c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-9.2-9.2-11.9-22.9-6.9-34.9S19 287.9 32 287.9h256c12.9 0 24.6 7.8 29.6 19.8s2.2 25.7-6.9 34.9l-128 128z"},null,-1),es=[Yt];function ts(e,s){return p(),m("svg",Xt,es)}var ss={name:"fa6-solid-sort-down",render:ts};function ne(e){return[null,void 0].indexOf(e)!==-1}function as(e,s,t){const{object:l,valueProp:i,mode:r}=X(e),n=ye().proxy,u=t.iv,y=v=>{u.value=o(v);const T=c(v);s.emit("change",T,n),s.emit("input",T),s.emit("update:modelValue",T)},c=v=>l.value||ne(v)?v:Array.isArray(v)?v.map(T=>T[i.value]):v[i.value],o=v=>ne(v)?r.value==="single"?{}:[]:v;return{update:y}}function ns(e,s){const{value:t,modelValue:l,mode:i,valueProp:r}=X(e),n=z(i.value!=="single"?[]:{}),u=l&&l.value!==void 0?l:t,y=w(()=>i.value==="single"?n.value[r.value]:n.value.map(o=>o[r.value])),c=w(()=>i.value!=="single"?n.value.map(o=>o[r.value]).join(","):n.value[r.value]);return{iv:n,internalValue:n,ev:u,externalValue:u,textValue:c,plainValue:y}}function is(e,s,t){const{regex:l}=X(e),i=ye().proxy,r=t.isOpen,n=t.open,u=z(null),y=z(null),c=()=>{u.value=""},o=B=>{u.value=B.target.value},v=B=>{if(l&&l.value){let E=l.value;typeof E=="string"&&(E=new RegExp(E)),B.key.match(E)||B.preventDefault()}},T=B=>{if(l&&l.value){let N=(B.clipboardData||window.clipboardData).getData("Text"),b=l.value;typeof b=="string"&&(b=new RegExp(b)),N.split("").every(q=>!!q.match(b))||B.preventDefault()}s.emit("paste",B,i)};return ee(u,B=>{!r.value&&B&&n(),s.emit("search-change",B,i)}),{search:u,input:y,clearSearch:c,handleSearchInput:o,handleKeypress:v,handlePaste:T}}function ls(e,s,t){const{groupSelect:l,mode:i,groups:r,disabledProp:n}=X(e),u=z(null),y=o=>{o===void 0||o!==null&&o[n.value]||r.value&&o&&o.group&&(i.value==="single"||!l.value)||(u.value=o)};return{pointer:u,setPointer:y,clearPointer:()=>{y(null)}}}function we(e,s=!0){return s?String(e).toLowerCase().trim():String(e).normalize("NFD").replace(/\p{Diacritic}/gu,"").toLowerCase().trim()}function rs(e){return Object.prototype.toString.call(e)==="[object Object]"}function os(e,s){const t=s.slice().sort();return e.length===s.length&&e.slice().sort().every(function(l,i){return l===t[i]})}function us(e,s,t){const{options:l,mode:i,trackBy:r,limit:n,hideSelected:u,createTag:y,createOption:c,label:o,appendNewTag:v,appendNewOption:T,multipleLabel:B,object:E,loading:N,delay:b,resolveOnLoad:q,minChars:h,filterResults:R,clearOnSearch:$,clearOnSelect:L,valueProp:O,canDeselect:V,max:F,strict:te,closeOnSelect:se,groups:ie,reverse:Q,infinite:fe,groupOptions:j,groupHideEmpty:be,groupSelect:ke,onCreate:A,disabledProp:D,searchStart:H}=X(e),G=ye().proxy,I=t.iv,le=t.ev,M=t.search,he=t.clearSearch,d=t.update,P=t.pointer,Z=t.clearPointer,Te=t.focus,it=t.deactivate,Ie=t.close,Be=z([]),re=z([]),ae=z(!1),Pe=z(null),Ee=z(fe.value&&n.value===-1?10:n.value),Ue=w(()=>y.value||c.value||!1),lt=w(()=>v.value!==void 0?v.value:T.value!==void 0?T.value:!0),ce=w(()=>{if(ie.value){let a=re.value||[],f=[];return a.forEach(C=>{Ke(C[j.value]).forEach(K=>{f.push(Object.assign({},K,C[D.value]?{[D.value]:!0}:{}))})}),f}else{let a=Ke(re.value||[]);return Be.value.length&&(a=a.concat(Be.value)),a}}),Qe=w(()=>ie.value?Ot((re.value||[]).map((a,f)=>{const C=Ke(a[j.value]);return{...a,index:f,group:!0,[j.value]:Me(C,!1).map(K=>Object.assign({},K,a[D.value]?{[D.value]:!0}:{})),__VISIBLE__:Me(C).map(K=>Object.assign({},K,a[D.value]?{[D.value]:!0}:{}))}})):[]),Ze=w(()=>{let a=ce.value;return Q.value&&(a=a.reverse()),Re.value.length&&(a=Re.value.concat(a)),Me(a)}),ge=w(()=>{let a=Ze.value;return Ee.value>0&&(a=a.slice(0,Ee.value)),a}),Ne=w(()=>{switch(i.value){case"single":return!ne(I.value[O.value]);case"multiple":case"tags":return!ne(I.value)&&I.value.length>0}}),rt=w(()=>B!==void 0&&B.value!==void 0?B.value(I.value,G):I.value&&I.value.length>1?`${I.value.length} options selected`:"1 option selected"),ot=w(()=>!ce.value.length&&!ae.value&&!Re.value.length),ut=w(()=>ce.value.length>0&&ge.value.length==0&&(M.value&&ie.value||!ie.value)),Re=w(()=>Ue.value===!1||!M.value?[]:yt(M.value)!==-1?[]:[{[O.value]:M.value,[o.value]:M.value,[oe.value]:M.value,__CREATE__:!0}]),oe=w(()=>r.value||o.value),ct=w(()=>{switch(i.value){case"single":return null;case"multiple":case"tags":return[]}}),dt=w(()=>N.value||ae.value),ve=a=>{switch(typeof a!="object"&&(a=ue(a)),i.value){case"single":d(a);break;case"multiple":case"tags":d(I.value.concat(a));break}s.emit("select",Je(a),a,G)},pe=a=>{switch(typeof a!="object"&&(a=ue(a)),i.value){case"single":Xe();break;case"tags":case"multiple":d(Array.isArray(a)?I.value.filter(f=>a.map(C=>C[O.value]).indexOf(f[O.value])===-1):I.value.filter(f=>f[O.value]!=a[O.value]));break}s.emit("deselect",Je(a),a,G)},Je=a=>E.value?a:a[O.value],xe=a=>{pe(a)},ft=(a,f)=>{if(f.button!==0){f.preventDefault();return}xe(a)},Xe=()=>{s.emit("clear",G),d(ct.value)},de=a=>{if(a.group!==void 0)return i.value==="single"?!1:gt(a[j.value])&&a[j.value].length;switch(i.value){case"single":return!ne(I.value)&&I.value[O.value]==a[O.value];case"tags":case"multiple":return!ne(I.value)&&I.value.map(f=>f[O.value]).indexOf(a[O.value])!==-1}},qe=a=>a[D.value]===!0,Ae=()=>F===void 0||F.value===-1||!Ne.value&&F.value>0?!1:I.value.length>=F.value,ht=a=>{if(!qe(a)){if(A&&A.value&&!de(a)&&a.__CREATE__&&(a={...a},delete a.__CREATE__,a=A.value(a,G),a instanceof Promise)){ae.value=!0,a.then(f=>{ae.value=!1,Ye(f)});return}Ye(a)}},Ye=a=>{switch(a.__CREATE__&&(a={...a},delete a.__CREATE__),i.value){case"single":if(a&&de(a)){V.value&&pe(a);return}a&&De(a),L.value&&he(),se.value&&(Z(),Ie()),a&&ve(a);break;case"multiple":if(a&&de(a)){pe(a);return}if(Ae())return;a&&(De(a),ve(a)),L.value&&he(),u.value&&Z(),se.value&&Ie();break;case"tags":if(a&&de(a)){pe(a);return}if(Ae())return;a&&De(a),L.value&&he(),a&&ve(a),u.value&&Z(),se.value&&Ie();break}se.value||Te()},vt=a=>{if(!(qe(a)||i.value==="single"||!ke.value)){switch(i.value){case"multiple":case"tags":mt(a[j.value])?pe(a[j.value]):ve(a[j.value].filter(f=>I.value.map(C=>C[O.value]).indexOf(f[O.value])===-1).filter(f=>!f[D.value]).filter((f,C)=>I.value.length+1+C<=F.value||F.value===-1));break}se.value&&it()}},De=a=>{ue(a[O.value])===void 0&&Ue.value&&(s.emit("tag",a[O.value],G),s.emit("option",a[O.value],G),lt.value&&kt(a),he())},pt=()=>{i.value!=="single"&&ve(ge.value)},mt=a=>a.find(f=>!de(f)&&!f[D.value])===void 0,gt=a=>a.find(f=>!de(f))===void 0,ue=a=>ce.value[ce.value.map(f=>String(f[O.value])).indexOf(String(a))],yt=(a,f=!0)=>ce.value.map(C=>parseInt(C[oe.value])==C[oe.value]?parseInt(C[oe.value]):C[oe.value]).indexOf(parseInt(a)==a?parseInt(a):a),bt=a=>["tags","multiple"].indexOf(i.value)!==-1&&u.value&&de(a),kt=a=>{Be.value.push(a)},Ot=a=>be.value?a.filter(f=>M.value?f.__VISIBLE__.length:f[j.value].length):a.filter(f=>M.value?f.__VISIBLE__.length:!0),Me=(a,f=!0)=>{let C=a;return M.value&&R.value&&(C=C.filter(K=>H.value?we(K[oe.value],te.value).startsWith(we(M.value,te.value)):we(K[oe.value],te.value).indexOf(we(M.value,te.value))!==-1)),u.value&&f&&(C=C.filter(K=>!bt(K))),C},Ke=a=>{let f=a;return rs(f)&&(f=Object.keys(f).map(C=>{let K=f[C];return{[O.value]:C,[oe.value]:K,[o.value]:K}})),f=f.map(C=>typeof C=="object"?C:{[O.value]:C,[oe.value]:C,[o.value]:C}),f},Oe=()=>{ne(le.value)||(I.value=_e(le.value))},Se=a=>(ae.value=!0,new Promise((f,C)=>{l.value(M.value,G).then(K=>{re.value=K||[],typeof a=="function"&&a(K),ae.value=!1}).catch(K=>{console.error(K),re.value=[],ae.value=!1}).finally(()=>{f()})})),Ve=()=>{if(!!Ne.value)if(i.value==="single"){let a=ue(I.value[O.value]);if(a!==void 0){let f=a[o.value];I.value[o.value]=f,E.value&&(le.value[o.value]=f)}}else I.value.forEach((a,f)=>{let C=ue(I.value[f][O.value]);if(C!==void 0){let K=C[o.value];I.value[f][o.value]=K,E.value&&(le.value[f][o.value]=K)}})},St=a=>{Se(a)},_e=a=>ne(a)?i.value==="single"?{}:[]:E.value?a:i.value==="single"?ue(a)||{}:a.filter(f=>!!ue(f)).map(f=>ue(f)),et=()=>{Pe.value=ee(M,a=>{a.length<h.value||!a&&h.value!==0||(ae.value=!0,$.value&&(re.value=[]),setTimeout(()=>{a==M.value&&l.value(M.value,G).then(f=>{(a==M.value||!M.value)&&(re.value=f,P.value=ge.value.filter(C=>C[D.value]!==!0)[0]||null,ae.value=!1)}).catch(f=>{console.error(f)})},b.value))},{flush:"sync"})};if(i.value!=="single"&&!ne(le.value)&&!Array.isArray(le.value))throw new Error(`v-model must be an array when using "${i.value}" mode`);return l&&typeof l.value=="function"?q.value?Se(Oe):E.value==!0&&Oe():(re.value=l.value,Oe()),b.value>-1&&et(),ee(b,(a,f)=>{Pe.value&&Pe.value(),a>=0&&et()}),ee(le,a=>{if(ne(a)){I.value=_e(a);return}switch(i.value){case"single":(E.value?a[O.value]!=I.value[O.value]:a!=I.value[O.value])&&(I.value=_e(a));break;case"multiple":case"tags":os(E.value?a.map(f=>f[O.value]):a,I.value.map(f=>f[O.value]))||(I.value=_e(a));break}},{deep:!0}),ee(l,(a,f)=>{typeof e.options=="function"?q.value&&(!f||a&&a.toString()!==f.toString())&&Se():(re.value=e.options,Object.keys(I.value).length||Oe(),Ve())}),ee(o,Ve),{pfo:Ze,fo:ge,filteredOptions:ge,hasSelected:Ne,multipleLabelText:rt,eo:ce,extendedOptions:ce,fg:Qe,filteredGroups:Qe,noOptions:ot,noResults:ut,resolving:ae,busy:dt,offset:Ee,select:ve,deselect:pe,remove:xe,selectAll:pt,clear:Xe,isSelected:de,isDisabled:qe,isMax:Ae,getOption:ue,handleOptionClick:ht,handleGroupClick:vt,handleTagRemove:ft,refreshOptions:St,resolveOptions:Se,refreshLabels:Ve}}function cs(e,s,t){const{valueProp:l,showOptions:i,searchable:r,groupLabel:n,groups:u,mode:y,groupSelect:c,disabledProp:o}=X(e),v=t.fo,T=t.fg,B=t.handleOptionClick,E=t.handleGroupClick,N=t.search,b=t.pointer,q=t.setPointer,h=t.clearPointer,R=t.multiselect,$=t.isOpen,L=w(()=>v.value.filter(d=>!d[o.value])),O=w(()=>T.value.filter(d=>!d[o.value])),V=w(()=>y.value!=="single"&&c.value),F=w(()=>b.value&&b.value.group),te=w(()=>M(b.value)),se=w(()=>{const d=F.value?b.value:M(b.value),P=O.value.map(Te=>Te[n.value]).indexOf(d[n.value]);let Z=O.value[P-1];return Z===void 0&&(Z=Q.value),Z}),ie=w(()=>{let d=O.value.map(P=>P.label).indexOf(F.value?b.value[n.value]:M(b.value)[n.value])+1;return O.value.length<=d&&(d=0),O.value[d]}),Q=w(()=>[...O.value].slice(-1)[0]),fe=w(()=>b.value.__VISIBLE__.filter(d=>!d[o.value])[0]),j=w(()=>{const d=te.value.__VISIBLE__.filter(P=>!P[o.value]);return d[d.map(P=>P[l.value]).indexOf(b.value[l.value])-1]}),be=w(()=>{const d=M(b.value).__VISIBLE__.filter(P=>!P[o.value]);return d[d.map(P=>P[l.value]).indexOf(b.value[l.value])+1]}),ke=w(()=>[...se.value.__VISIBLE__.filter(d=>!d[o.value])].slice(-1)[0]),A=w(()=>[...Q.value.__VISIBLE__.filter(d=>!d[o.value])].slice(-1)[0]),D=d=>!!b.value&&(!d.group&&b.value[l.value]==d[l.value]||d.group!==void 0&&b.value[n.value]==d[n.value])?!0:void 0,H=()=>{q(L.value[0]||null)},G=()=>{!b.value||b.value[o.value]===!0||(F.value?E(b.value):B(b.value))},I=()=>{if(b.value===null)q((u.value&&V.value?O.value[0]:L.value[0])||null);else if(u.value&&V.value){let d=F.value?fe.value:be.value;d===void 0&&(d=ie.value),q(d||null)}else{let d=L.value.map(P=>P[l.value]).indexOf(b.value[l.value])+1;L.value.length<=d&&(d=0),q(L.value[d]||null)}Le(()=>{he()})},le=()=>{if(b.value===null){let d=L.value[L.value.length-1];u.value&&V.value&&(d=A.value,d===void 0&&(d=Q.value)),q(d||null)}else if(u.value&&V.value){let d=F.value?ke.value:j.value;d===void 0&&(d=F.value?se.value:te.value),q(d||null)}else{let d=L.value.map(P=>P[l.value]).indexOf(b.value[l.value])-1;d<0&&(d=L.value.length-1),q(L.value[d]||null)}Le(()=>{he()})},M=d=>O.value.find(P=>P.__VISIBLE__.map(Z=>Z[l.value]).indexOf(d[l.value])!==-1),he=()=>{let d=R.value.querySelector("[data-pointed]");if(!d)return;let P=d.parentElement.parentElement;u.value&&(P=F.value?d.parentElement.parentElement.parentElement:d.parentElement.parentElement.parentElement.parentElement),d.offsetTop+d.offsetHeight>P.clientHeight+P.scrollTop&&(P.scrollTop=d.offsetTop+d.offsetHeight-P.clientHeight),d.offsetTop<P.scrollTop&&(P.scrollTop=d.offsetTop)};return ee(N,d=>{r.value&&(d.length&&i.value?H():h())}),ee($,d=>{if(d){let P=R.value.querySelectorAll("[data-selected]")[0];if(!P)return;let Z=P.parentElement.parentElement;Le(()=>{Z.scrollTop>0||(Z.scrollTop=P.offsetTop)})}}),{pointer:b,canPointGroups:V,isPointed:D,setPointerFirst:H,selectPointer:G,forwardPointer:I,backwardPointer:le}}function ds(e,s,t){const{disabled:l}=X(e),i=ye().proxy,r=z(!1);return{isOpen:r,open:()=>{r.value||l.value||(r.value=!0,s.emit("open",i))},close:()=>{!r.value||(r.value=!1,s.emit("close",i))}}}function fs(e,s,t){const{searchable:l,disabled:i}=X(e),r=t.input,n=t.open,u=t.close,y=t.clearSearch,c=t.isOpen,o=z(null),v=z(null),T=z(!1),B=z(!1),E=w(()=>l.value||i.value?-1:0),N=()=>{l.value&&r.value.blur(),o.value.blur()},b=()=>{l.value&&!i.value&&r.value.focus()},q=(V=!0)=>{i.value||(T.value=!0,V&&n())},h=()=>{T.value=!1,setTimeout(()=>{T.value||(u(),y())},1)};return{multiselect:o,tags:v,tabindex:E,isActive:T,mouseClicked:B,blur:N,focus:b,activate:q,deactivate:h,handleFocusIn:()=>{q(B.value)},handleFocusOut:()=>{h()},handleCaretClick:()=>{h(),N()},handleMousedown:V=>{B.value=!0,c.value&&(V.target.isEqualNode(o.value)||V.target.isEqualNode(v.value))?setTimeout(()=>{h()},0):document.activeElement.isEqualNode(o.value)&&!c.value&&q(),setTimeout(()=>{B.value=!1},0)}}}function hs(e,s,t){const{mode:l,addTagOn:i,openDirection:r,searchable:n,showOptions:u,valueProp:y,groups:c,addOptionOn:o,createTag:v,createOption:T,reverse:B}=X(e),E=ye().proxy,N=t.iv,b=t.update,q=t.search,h=t.setPointer,R=t.selectPointer,$=t.backwardPointer,L=t.forwardPointer,O=t.multiselect,V=t.tags,F=t.isOpen,te=t.open,se=t.blur,ie=t.fo,Q=w(()=>v.value||T.value||!1),fe=w(()=>i.value!==void 0?i.value:o.value!==void 0?o.value:["enter"]),j=()=>{l.value==="tags"&&!u.value&&Q.value&&n.value&&!c.value&&h(ie.value[ie.value.map(A=>A[y.value]).indexOf(q.value)])};return{handleKeydown:A=>{s.emit("keydown",A,E);let D,H;switch(["ArrowLeft","ArrowRight","Enter"].indexOf(A.key)!==-1&&l.value==="tags"&&(D=[...O.value.querySelectorAll("[data-tags] > *")].filter(G=>G!==V.value),H=D.findIndex(G=>G===document.activeElement)),A.key){case"Backspace":if(l.value==="single"||n.value&&[null,""].indexOf(q.value)===-1||N.value.length===0)return;b([...N.value].slice(0,-1));break;case"Enter":if(A.preventDefault(),H!==-1&&H!==void 0){b([...N.value].filter((G,I)=>I!==H)),H===D.length-1&&(D.length-1?D[D.length-2].focus():n.value?V.value.querySelector("input").focus():O.value.focus());return}if(fe.value.indexOf("enter")===-1&&Q.value)return;j(),R();break;case" ":if(!Q.value&&!n.value){A.preventDefault(),j(),R();return}if(!Q.value)return!1;if(fe.value.indexOf("space")===-1&&Q.value)return;A.preventDefault(),j(),R();break;case"Tab":case";":case",":if(fe.value.indexOf(A.key.toLowerCase())===-1||!Q.value)return;j(),R(),A.preventDefault();break;case"Escape":se();break;case"ArrowUp":if(A.preventDefault(),!u.value)return;F.value||te(),$();break;case"ArrowDown":if(A.preventDefault(),!u.value)return;F.value||te(),L();break;case"ArrowLeft":if(n.value&&V.value.querySelector("input").selectionStart||A.shiftKey||l.value!=="tags"||!N.value||!N.value.length)return;A.preventDefault(),H===-1?D[D.length-1].focus():H>0&&D[H-1].focus();break;case"ArrowRight":if(H===-1||A.shiftKey||l.value!=="tags"||!N.value||!N.value.length)return;A.preventDefault(),D.length>H+1?D[H+1].focus():n.value?V.value.querySelector("input").focus():n.value||O.value.focus();break}},handleKeyup:A=>{s.emit("keyup",A,E)},preparePointer:j}}function vs(e,s,t){const{classes:l,disabled:i,openDirection:r,showOptions:n}=X(e),u=t.isOpen,y=t.isPointed,c=t.isSelected,o=t.isDisabled,v=t.isActive,T=t.canPointGroups,B=t.resolving,E=t.fo,N=w(()=>({container:"multiselect",containerDisabled:"is-disabled",containerOpen:"is-open",containerOpenTop:"is-open-top",containerActive:"is-active",singleLabel:"multiselect-single-label",singleLabelText:"multiselect-single-label-text",multipleLabel:"multiselect-multiple-label",search:"multiselect-search",tags:"multiselect-tags",tag:"multiselect-tag",tagDisabled:"is-disabled",tagRemove:"multiselect-tag-remove",tagRemoveIcon:"multiselect-tag-remove-icon",tagsSearchWrapper:"multiselect-tags-search-wrapper",tagsSearch:"multiselect-tags-search",tagsSearchCopy:"multiselect-tags-search-copy",placeholder:"multiselect-placeholder",caret:"multiselect-caret",caretOpen:"is-open",clear:"multiselect-clear",clearIcon:"multiselect-clear-icon",spinner:"multiselect-spinner",inifinite:"multiselect-inifite",inifiniteSpinner:"multiselect-inifite-spinner",dropdown:"multiselect-dropdown",dropdownTop:"is-top",dropdownHidden:"is-hidden",options:"multiselect-options",optionsTop:"is-top",group:"multiselect-group",groupLabel:"multiselect-group-label",groupLabelPointable:"is-pointable",groupLabelPointed:"is-pointed",groupLabelSelected:"is-selected",groupLabelDisabled:"is-disabled",groupLabelSelectedPointed:"is-selected is-pointed",groupLabelSelectedDisabled:"is-selected is-disabled",groupOptions:"multiselect-group-options",option:"multiselect-option",optionPointed:"is-pointed",optionSelected:"is-selected",optionDisabled:"is-disabled",optionSelectedPointed:"is-selected is-pointed",optionSelectedDisabled:"is-selected is-disabled",noOptions:"multiselect-no-options",noResults:"multiselect-no-results",fakeInput:"multiselect-fake-input",spacer:"multiselect-spacer",...l.value})),b=w(()=>!!(u.value&&n.value&&(!B.value||B.value&&E.value.length)));return{classList:w(()=>{const h=N.value;return{container:[h.container].concat(i.value?h.containerDisabled:[]).concat(b.value&&r.value==="top"?h.containerOpenTop:[]).concat(b.value&&r.value!=="top"?h.containerOpen:[]).concat(v.value?h.containerActive:[]),spacer:h.spacer,singleLabel:h.singleLabel,singleLabelText:h.singleLabelText,multipleLabel:h.multipleLabel,search:h.search,tags:h.tags,tag:[h.tag].concat(i.value?h.tagDisabled:[]),tagRemove:h.tagRemove,tagRemoveIcon:h.tagRemoveIcon,tagsSearchWrapper:h.tagsSearchWrapper,tagsSearch:h.tagsSearch,tagsSearchCopy:h.tagsSearchCopy,placeholder:h.placeholder,caret:[h.caret].concat(u.value?h.caretOpen:[]),clear:h.clear,clearIcon:h.clearIcon,spinner:h.spinner,inifinite:h.inifinite,inifiniteSpinner:h.inifiniteSpinner,dropdown:[h.dropdown].concat(r.value==="top"?h.dropdownTop:[]).concat(!u.value||!n.value||!b.value?h.dropdownHidden:[]),options:[h.options].concat(r.value==="top"?h.optionsTop:[]),group:h.group,groupLabel:R=>{let $=[h.groupLabel];return y(R)?$.push(c(R)?h.groupLabelSelectedPointed:h.groupLabelPointed):c(R)&&T.value?$.push(o(R)?h.groupLabelSelectedDisabled:h.groupLabelSelected):o(R)&&$.push(h.groupLabelDisabled),T.value&&$.push(h.groupLabelPointable),$},groupOptions:h.groupOptions,option:(R,$)=>{let L=[h.option];return y(R)?L.push(c(R)?h.optionSelectedPointed:h.optionPointed):c(R)?L.push(o(R)?h.optionSelectedDisabled:h.optionSelected):(o(R)||$&&o($))&&L.push(h.optionDisabled),L},noOptions:h.noOptions,noResults:h.noResults,fakeInput:h.fakeInput}}),showDropdown:b}}function ps(e,s,t){const{limit:l,infinite:i}=X(e),r=t.isOpen,n=t.offset,u=t.search,y=t.pfo,c=t.eo,o=z(null),v=z(null),T=w(()=>n.value<y.value.length),B=N=>{const{isIntersecting:b,target:q}=N[0];if(b){const h=q.offsetParent,R=h.scrollTop;n.value+=l.value==-1?10:l.value,Le(()=>{h.scrollTop=R})}},E=()=>{r.value&&n.value<y.value.length?o.value.observe(v.value):!r.value&&o.value&&o.value.disconnect()};return ee(r,()=>{!i.value||E()}),ee(u,()=>{!i.value||(n.value=l.value,E())},{flush:"post"}),ee(c,()=>{!i.value||E()},{immediate:!1,flush:"post"}),at(()=>{window&&window.IntersectionObserver&&(o.value=new IntersectionObserver(B))}),{hasMore:T,infiniteLoader:v}}function ms(e,s,t){const{placeholder:l,id:i,valueProp:r,label:n,mode:u,groupLabel:y}=X(e),c=t.pointer;t.iv,t.hasSelected,t.multipleLabelText,t.isOpen;const o=z(null),v=w(()=>{let $=[];return i&&i.value&&$.push(i.value),$.push("multiselect-options"),$.join("-")}),T=w(()=>{let $=[];if(i&&i.value&&$.push(i.value),c.value)return $.push(c.value.group?"multiselect-group":"multiselect-option"),$.push(c.value.group?c.value.index:c.value[r.value]),$.join("-")}),B=w(()=>l.value),E=w(()=>u.value!=="single"),N=$=>{let L=[];return i&&i.value&&L.push(i.value),L.push("multiselect-option"),L.push($[r.value]),L.join("-")},b=$=>{let L=[];return i&&i.value&&L.push(i.value),L.push("multiselect-group"),L.push($.index),L.join("-")},q=$=>{let L=[];return L.push($[n.value]),L.join(" ")},h=$=>{let L=[];return L.push($[y.value]),L.join(" ")},R=$=>`${$} \u274E`;return at(()=>{if(i&&i.value&&document&&document.querySelector){let $=document.querySelector(`[for="${i.value}"]`);o.value=$?$.innerText:null}}),{ariaOwns:v,ariaPlaceholder:B,ariaMultiselectable:E,ariaActiveDescendant:T,ariaOptionId:N,ariaOptionLabel:q,ariaGroupId:b,ariaGroupLabel:h,ariaTagLabel:R}}function gs(e,s,t,l={}){return t.forEach(i=>{i&&(l={...l,...i(e,s,l)})}),l}var We={name:"Multiselect",emits:["paste","open","close","select","deselect","input","search-change","tag","option","update:modelValue","change","clear","keydown","keyup"],props:{value:{required:!1},modelValue:{required:!1},options:{type:[Array,Object,Function],required:!1,default:()=>[]},id:{type:[String,Number],required:!1},name:{type:[String,Number],required:!1,default:"multiselect"},disabled:{type:Boolean,required:!1,default:!1},label:{type:String,required:!1,default:"label"},trackBy:{type:String,required:!1,default:void 0},valueProp:{type:String,required:!1,default:"value"},placeholder:{type:String,required:!1,default:null},mode:{type:String,required:!1,default:"single"},searchable:{type:Boolean,required:!1,default:!1},limit:{type:Number,required:!1,default:-1},hideSelected:{type:Boolean,required:!1,default:!0},createTag:{type:Boolean,required:!1,default:void 0},createOption:{type:Boolean,required:!1,default:void 0},appendNewTag:{type:Boolean,required:!1,default:void 0},appendNewOption:{type:Boolean,required:!1,default:void 0},addTagOn:{type:Array,required:!1,default:void 0},addOptionOn:{type:Array,required:!1,default:void 0},caret:{type:Boolean,required:!1,default:!0},loading:{type:Boolean,required:!1,default:!1},noOptionsText:{type:String,required:!1,default:"The list is empty"},noResultsText:{type:String,required:!1,default:"No results found"},multipleLabel:{type:Function,required:!1},object:{type:Boolean,required:!1,default:!1},delay:{type:Number,required:!1,default:-1},minChars:{type:Number,required:!1,default:0},resolveOnLoad:{type:Boolean,required:!1,default:!0},filterResults:{type:Boolean,required:!1,default:!0},clearOnSearch:{type:Boolean,required:!1,default:!1},clearOnSelect:{type:Boolean,required:!1,default:!0},canDeselect:{type:Boolean,required:!1,default:!0},canClear:{type:Boolean,required:!1,default:!0},max:{type:Number,required:!1,default:-1},showOptions:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1,default:!1},openDirection:{type:String,required:!1,default:"bottom"},nativeSupport:{type:Boolean,required:!1,default:!1},classes:{type:Object,required:!1,default:()=>({})},strict:{type:Boolean,required:!1,default:!0},closeOnSelect:{type:Boolean,required:!1,default:!0},autocomplete:{type:String,required:!1},groups:{type:Boolean,required:!1,default:!1},groupLabel:{type:String,required:!1,default:"label"},groupOptions:{type:String,required:!1,default:"options"},groupHideEmpty:{type:Boolean,required:!1,default:!1},groupSelect:{type:Boolean,required:!1,default:!0},inputType:{type:String,required:!1,default:"text"},attrs:{required:!1,type:Object,default:()=>({})},onCreate:{required:!1,type:Function},disabledProp:{type:String,required:!1,default:"disabled"},searchStart:{type:Boolean,required:!1,default:!1},reverse:{type:Boolean,required:!1,default:!1},regex:{type:[Object,String,RegExp],required:!1,default:void 0},rtl:{type:Boolean,required:!1,default:!1},infinite:{type:Boolean,required:!1,default:!1},aria:{required:!1,type:Object,default:()=>({})}},setup(e,s){return gs(e,s,[ns,ls,ds,is,as,fs,us,ps,cs,hs,vs,ms])}};const ys=["tabindex","id","dir","aria-owns","aria-placeholder","aria-expanded","aria-activedescendant","aria-multiselectable","role"],bs=["type","modelValue","value","autocomplete","id","aria-owns","aria-placeholder","aria-expanded","aria-activedescendant","aria-multiselectable"],ks=["onKeyup","aria-label"],Os=["onClick"],Ss=["type","modelValue","value","id","autocomplete","aria-owns","aria-placeholder","aria-expanded","aria-activedescendant","aria-multiselectable"],_s=["innerHTML"],ws=["innerHTML"],Ls=["id"],$s=["id","aria-label","aria-selected"],Cs=["data-pointed","onMouseenter","onClick"],Ts=["innerHTML"],Is=["aria-label"],Bs=["data-pointed","data-selected","onMouseenter","onClick","id","aria-selected","aria-label"],Ps=["innerHTML"],Es=["data-pointed","data-selected","onMouseenter","onClick","id","aria-selected","aria-label"],Ns=["innerHTML"],Rs=["innerHTML"],qs=["innerHTML"],As=["value"],Ds=["name","value"],Ms=["name","value"];function Ks(e,s,t,l,i,r){return p(),m("div",Fe({ref:"multiselect",tabindex:e.tabindex,class:e.classList.container,id:t.searchable?void 0:t.id,dir:t.rtl?"rtl":void 0,onFocusin:s[9]||(s[9]=(...n)=>e.handleFocusIn&&e.handleFocusIn(...n)),onFocusout:s[10]||(s[10]=(...n)=>e.handleFocusOut&&e.handleFocusOut(...n)),onKeydown:s[11]||(s[11]=(...n)=>e.handleKeydown&&e.handleKeydown(...n)),onKeyup:s[12]||(s[12]=(...n)=>e.handleKeyup&&e.handleKeyup(...n)),onMousedown:s[13]||(s[13]=(...n)=>e.handleMousedown&&e.handleMousedown(...n)),"aria-owns":t.searchable?void 0:e.ariaOwns,"aria-placeholder":t.searchable?void 0:e.ariaPlaceholder,"aria-expanded":t.searchable?void 0:e.isOpen,"aria-activedescendant":t.searchable?void 0:e.ariaActiveDescendant,"aria-multiselectable":t.searchable?void 0:e.ariaMultiselectable,role:t.searchable?void 0:"listbox"},t.searchable?{}:t.aria),[k(" Search "),t.mode!=="tags"&&t.searchable&&!t.disabled?(p(),m("input",Fe({key:0,type:t.inputType,modelValue:e.search,value:e.search,class:e.classList.search,autocomplete:t.autocomplete,id:t.searchable?t.id:void 0,onInput:s[0]||(s[0]=(...n)=>e.handleSearchInput&&e.handleSearchInput(...n)),onKeypress:s[1]||(s[1]=(...n)=>e.handleKeypress&&e.handleKeypress(...n)),onPaste:s[2]||(s[2]=tt((...n)=>e.handlePaste&&e.handlePaste(...n),["stop"])),ref:"input","aria-owns":e.ariaOwns,"aria-placeholder":e.ariaPlaceholder,"aria-expanded":e.isOpen,"aria-activedescendant":e.ariaActiveDescendant,"aria-multiselectable":e.ariaMultiselectable,role:"listbox"},{...t.attrs,...t.aria}),null,16,bs)):k("v-if",!0),k(" Tags (with search) "),t.mode=="tags"?(p(),m("div",{key:1,class:S(e.classList.tags),"data-tags":""},[(p(!0),m(x,null,Y(e.iv,(n,u,y)=>W(e.$slots,"tag",{option:n,handleTagRemove:e.handleTagRemove,disabled:t.disabled},()=>[(p(),m("span",{class:S(e.classList.tag),tabindex:"-1",onKeyup:ze(c=>e.handleTagRemove(n,c),["enter"]),key:y,"aria-label":e.ariaTagLabel(n[t.label])},[He(U(n[t.label])+" ",1),t.disabled?k("v-if",!0):(p(),m("span",{key:0,class:S(e.classList.tagRemove),onClick:c=>e.handleTagRemove(n,c)},[g("span",{class:S(e.classList.tagRemoveIcon)},null,2)],10,Os))],42,ks))])),256)),g("div",{class:S(e.classList.tagsSearchWrapper),ref:"tags"},[k(" Used for measuring search width "),g("span",{class:S(e.classList.tagsSearchCopy)},U(e.search),3),k(" Actual search input "),t.searchable&&!t.disabled?(p(),m("input",Fe({key:0,type:t.inputType,modelValue:e.search,value:e.search,class:e.classList.tagsSearch,id:t.searchable?t.id:void 0,autocomplete:t.autocomplete,onInput:s[3]||(s[3]=(...n)=>e.handleSearchInput&&e.handleSearchInput(...n)),onKeypress:s[4]||(s[4]=(...n)=>e.handleKeypress&&e.handleKeypress(...n)),onPaste:s[5]||(s[5]=tt((...n)=>e.handlePaste&&e.handlePaste(...n),["stop"])),ref:"input","aria-owns":e.ariaOwns,"aria-placeholder":e.ariaPlaceholder,"aria-expanded":e.isOpen,"aria-activedescendant":e.ariaActiveDescendant,"aria-multiselectable":e.ariaMultiselectable,role:"listbox"},{...t.attrs,...t.aria}),null,16,Ss)):k("v-if",!0)],2)],2)):k("v-if",!0),k(" Single label "),t.mode=="single"&&e.hasSelected&&!e.search&&e.iv?W(e.$slots,"singlelabel",{key:2,value:e.iv},()=>[g("div",{class:S(e.classList.singleLabel),"aria-hidden":"true"},[g("span",{class:S(e.classList.singleLabelText),innerHTML:e.iv[t.label]},null,10,_s)],2)]):k("v-if",!0),k(" Multiple label "),t.mode=="multiple"&&e.hasSelected&&!e.search?W(e.$slots,"multiplelabel",{key:3,values:e.iv},()=>[g("div",{class:S(e.classList.multipleLabel),innerHTML:e.multipleLabelText,"aria-hidden":"true"},null,10,ws)]):k("v-if",!0),k(" Placeholder "),t.placeholder&&!e.hasSelected&&!e.search?W(e.$slots,"placeholder",{key:4},()=>[g("div",{class:S(e.classList.placeholder),"aria-hidden":"true"},U(t.placeholder),3)]):k("v-if",!0),k(" Spinner "),t.loading||e.resolving?W(e.$slots,"spinner",{key:5},()=>[g("span",{class:S(e.classList.spinner),"aria-hidden":"true"},null,2)]):k("v-if",!0),k(" Clear "),e.hasSelected&&!t.disabled&&t.canClear&&!e.busy?W(e.$slots,"clear",{key:6,clear:e.clear},()=>[g("span",{tabindex:"0",role:"button","aria-label":"\u274E",class:S(e.classList.clear),onClick:s[6]||(s[6]=(...n)=>e.clear&&e.clear(...n)),onKeyup:s[7]||(s[7]=ze((...n)=>e.clear&&e.clear(...n),["enter"]))},[g("span",{class:S(e.classList.clearIcon)},null,2)],34)]):k("v-if",!0),k(" Caret "),t.caret&&t.showOptions?W(e.$slots,"caret",{key:7},()=>[g("span",{class:S(e.classList.caret),onClick:s[8]||(s[8]=(...n)=>e.handleCaretClick&&e.handleCaretClick(...n)),"aria-hidden":"true"},null,2)]):k("v-if",!0),k(" Options "),g("div",{class:S(e.classList.dropdown),tabindex:"-1"},[W(e.$slots,"beforelist",{options:e.fo}),g("ul",{class:S(e.classList.options),id:e.ariaOwns},[t.groups?(p(!0),m(x,{key:0},Y(e.fg,(n,u,y)=>(p(),m("li",{class:S(e.classList.group),key:y,id:e.ariaGroupId(n),"aria-label":e.ariaGroupLabel(n),"aria-selected":e.isSelected(n),role:"option"},[g("div",{class:S(e.classList.groupLabel(n)),"data-pointed":e.isPointed(n),onMouseenter:c=>e.setPointer(n,u),onClick:c=>e.handleGroupClick(n)},[W(e.$slots,"grouplabel",{group:n,isSelected:e.isSelected,isPointed:e.isPointed},()=>[g("span",{innerHTML:n[t.groupLabel]},null,8,Ts)])],42,Cs),g("ul",{class:S(e.classList.groupOptions),"aria-label":e.ariaGroupLabel(n),role:"group"},[(p(!0),m(x,null,Y(n.__VISIBLE__,(c,o,v)=>(p(),m("li",{class:S(e.classList.option(c,n)),"data-pointed":e.isPointed(c),"data-selected":e.isSelected(c)||void 0,key:v,onMouseenter:T=>e.setPointer(c),onClick:T=>e.handleOptionClick(c),id:e.ariaOptionId(c),"aria-selected":e.isSelected(c),"aria-label":e.ariaOptionLabel(c),role:"option"},[W(e.$slots,"option",{option:c,isSelected:e.isSelected,isPointed:e.isPointed,search:e.search},()=>[g("span",{innerHTML:c[t.label]},null,8,Ps)])],42,Bs))),128))],10,Is)],10,$s))),128)):(p(!0),m(x,{key:1},Y(e.fo,(n,u,y)=>(p(),m("li",{class:S(e.classList.option(n)),"data-pointed":e.isPointed(n),"data-selected":e.isSelected(n)||void 0,key:y,onMouseenter:c=>e.setPointer(n),onClick:c=>e.handleOptionClick(n),id:e.ariaOptionId(n),"aria-selected":e.isSelected(n),"aria-label":e.ariaOptionLabel(n),role:"option"},[W(e.$slots,"option",{option:n,isSelected:e.isSelected,isPointed:e.isPointed,search:e.search},()=>[g("span",{innerHTML:n[t.label]},null,8,Ns)])],42,Es))),128))],10,Ls),e.noOptions?W(e.$slots,"nooptions",{key:0},()=>[g("div",{class:S(e.classList.noOptions),innerHTML:t.noOptionsText},null,10,Rs)]):k("v-if",!0),e.noResults?W(e.$slots,"noresults",{key:1},()=>[g("div",{class:S(e.classList.noResults),innerHTML:t.noResultsText},null,10,qs)]):k("v-if",!0),t.infinite&&e.hasMore?(p(),m("div",{key:2,class:S(e.classList.inifinite),ref:"infiniteLoader"},[W(e.$slots,"infinite",{},()=>[g("span",{class:S(e.classList.inifiniteSpinner)},null,2)])],2)):k("v-if",!0),W(e.$slots,"afterlist",{options:e.fo})],2),k(" Hacky input element to show HTML5 required warning "),t.required?(p(),m("input",{key:8,class:S(e.classList.fakeInput),tabindex:"-1",value:e.textValue,required:""},null,10,As)):k("v-if",!0),k(" Native input support "),t.nativeSupport?(p(),m(x,{key:9},[t.mode=="single"?(p(),m("input",{key:0,type:"hidden",name:t.name,value:e.plainValue!==void 0?e.plainValue:""},null,8,Ds)):(p(!0),m(x,{key:1},Y(e.plainValue,(n,u)=>(p(),m("input",{type:"hidden",name:`${t.name}[]`,value:n,key:u},null,8,Ms))),128))],64)):k("v-if",!0),k(" Create height for empty input "),g("div",{class:S(e.classList.spacer)},null,2)],16,ys)}We.render=Ks;We.__file="src/Multiselect.vue";const Vs={name:"sorter",props:["label","currentList","listName","item","index","tippyTop"],mixins:[_t],components:{VueSlider:wt,Multiselect:We},data:function(){return{range:null,dropdownOptions:null}},created:function(){if(this.item.range){var e={min:this.item.rangeMin(),max:this.item.rangeMax()};e.min<0&&(e.min=0),e.max<0&&(e.max=0),e.min>e.max&&(e.min=e.max),_.isArray(this.item.range)?(e.value=_.clone(this.item.range),(e.value[0]<e.min||e.value[0]>e.max)&&(e.value[0]=e.min),(e.value[1]<e.min||e.value[1]>e.max)&&(e.value[1]=e.max)):e.value=[e.min,e.max],this.item.rangeMarks&&(e.marks=this.item.rangeMarks(e)),this.range=e}else this.$store.getters.filterExtrasKeys.match(this.item.key)&&!this.dropdownOptions&&!!this.item.dropdownOpts&&(this.dropdownOptions=this.item.dropdownOpts())},computed:{filterAmounts:function(){this.$compEmitter.emit("repositionSearchOpts");let e=!(this.item.range||this.item.dropdownOpts),s=!e&&this.item.active===!0;if(e||s){const t=this,l=_.filter(this.$store.state.listRenderingOpts.filter,{type:"filterExtras",active:!0});let i=function(n){let u=_.map(l,function(y){return!!y.condition(n,y)});return!_.includes(u,!1)},r=this.item.type==="filter"?this.$store.getters.searchIsActive?this.$store.state.searchCollection:this.$store.getters.collectionSource:this.$store.getters.collection;return _.filter(r,function(n){return t.item.condition(n)&&i(n)}).length}else return 0},rangeVal:function(){return this.range.value},inputVmodel:{get:function(){return this.item.active},set:function(e){let s={listName:this.listName,key:this.item.key,active:e};this.item.range&&(s.range=e?_.clone(this.range.value):!0),this.item.group&&(s.group=!0),this.$store.commit("updateListRenderingOpts",s),this.doTheThings(e)}},isActiveSortItem:function(){if(this.listName==="sort"){if(!this.$store.getters.searchIsActive||this.$store.getters.searchIsActive&&this.$route.query.sort)return _.findIndex(this.currentList,"current")===this.index}else if(this.listName==="filter")return!1}},methods:{tooltipFormatter:function(e){return e+this.item.rangeSuffix},dropdownChanged:function(e){let s={listName:this.listName,key:this.item.key,active:e.length>0,value:e};this.item.group&&(s.group=!0),this.$store.commit("updateListRenderingOpts",s),this.doTheThings(e,!0)},dropdownOpened:function(e){!this.dropdownOptions&&!!this.item.dropdownOpts&&(this.dropdownOptions=this.item.dropdownOpts())},rangeChanged:function(e){this.range.value=e;let s={listName:this.listName,key:this.item.key,range:e,active:!0};this.item.group&&(s.group=!0),this.$store.commit("updateListRenderingOpts",s),this.doTheThings(e,!0)},adjustRange:function(e){let s={listName:this.listName,key:this.item.key,active:!0,range:[0,0]};if(e==="left"){const t=this.range.min;s.range[0]=t,this.range.value=[t,this.range.value[1]]}else{const t=this.range.max;s.range[1]=t,this.range.value=[this.range.value[0],t]}this.item.group&&(s.group=!0),this.$store.commit("updateListRenderingOpts",s),this.doTheThings(s.range,!0)},doTheThings:function(e,s){const t={change:{scope:this.listName==="scope",sort:this.listName==="sort",filter:this.listName==="filter"},randomize:this.item.key==="randomize"&&!this.$store.getters.searchIsActive,noSortvalues:this.item.key!=="sortValues",start:""};t.change.scope?t.start="start-scope":(t.change.sort||t.randomize)&&t.noSortvalues?(this.$store.commit("prop",{key:"searchSort",value:!1}),t.start="start-sort"):t.change.filter&&(t.start="start-filter"),this.saveOptions(e,s),this.$compEmitter.emit(t.start)},saveOptions:function(e,s){const t=this.item.key,l=this.item.type,i={};if(t==="sortValues")i[t]=e;else if(l==="sort")i[l]=t,i.sortDir=e?"desc":"asc";else if(this.listName==="filter"){if(l==="filter"&&(i[l]=encodeURIComponent(this.$store.getters.filterKeys)),l==="filterExtras"){this.$route.name==="series"&&t.match(/inLibrary|notInLibrary/)&&this.$store.commit("prop",{key:"sticky.seriesFilters."+t,value:e});let r=this;const n=r.$store.getters.filterExtrasKeys,u=n?_.map(n.split(","),function(y){const c=_.find(r.$store.state.listRenderingOpts.filter,{key:y});let o=_.get(r.range,"value");if(o||(o=_.get(c,"range")),o&&_.isArray(o))return encodeURIComponent(y+":"+o[0]+"-"+(o[1]||o[0]));if(_.get(c,"value.0"))return encodeURIComponent(y+":")+encodeURIComponent(_.map(c.value,function(v){return v}).join("|"));if(y)return encodeURIComponent(y)}):!1;i[l]=u?u.join(","):null}}else this.listName==="scope"&&(i[this.listName]=encodeURIComponent(this.$store.getters.scopeKeys));i.book=null,this.$store.commit("prop",{key:"bookClicked",value:!0}),this.$updateQueries(i,{src:"saveOptions"})}}},Fs={class:"sorter-button-wrapper"},js=["content"],zs=["value"],Hs={key:2,class:"radiobutton"},Gs={key:3,class:"checkbox"},Ws={key:0,class:"dropdown-label-suffix"},Us={key:0,class:"label-exclude"},Qs={key:1,class:"label-include"},Zs={key:5,class:"books-in-filter"},Js={key:0,class:"range-slider"},xs={key:1};function Xs(e,s,t,l,i,r){const n=ss,u=xt,y=Wt,c=Ft,o=At,v=Lt,T=st("vue-slider"),B=st("Multiselect"),E=Ge("tippy");return p(),m("span",Fs,[t.item?me((p(),m("span",{key:0,class:S(t.item.key),content:t.item.tippy?t.item.tippy:!1},[g("label",{class:S(["sorter-button",{ranged:t.item.range,"faux-disabled":t.item.type==="filterExtras"?r.filterAmounts<1:!1,"is-dropdown":t.item.dropdownOpts}])},[t.label===!1?(p(),m("span",{key:0,class:S(["input-label",{active:r.isActiveSortItem}])},[W(e.$slots,"default",{},void 0,!0)],2)):k("",!0),me(g("input",{type:"checkbox",value:t.index,"onUpdate:modelValue":s[0]||(s[0]=N=>r.inputVmodel=N)},null,8,zs),[[Ct,r.inputVmodel]]),t.item.type==="sort"?(p(),m("span",{key:1,class:S(["sortbox",{active:r.isActiveSortItem}])},[J(n,{"data-icon":"sort-down"}),J(u,{"data-icon":"sort-up"})],2)):t.item.radiobutton?(p(),m("span",Hs,[J(y,{"data-icon":"circle"}),J(c,{"data-icon":"circle"})])):(p(),m("span",Gs,[J(o,{"data-icon":"square"}),J(v,{"data-icon":"check"})])),t.label!==!1?(p(),m("span",{key:4,class:S(["input-label",{active:r.isActiveSortItem}])},[g("span",null,[He(U(t.item.label||t.item.key.replace(".name",""))+" ",1),t.item.dropdownOpts?(p(),m("span",Ws,[t.item.exclude?(p(),m("span",Us,"Exclude")):(p(),m("span",Qs,"Include"))])):k("",!0)])],2)):k("",!0),t.listName==="filter"?(p(),m("span",Zs,U(r.filterAmounts),1)):k("",!0)],2),t.item.range?(p(),m("div",Js,[g("span",{style:{"font-size":"13px","line-height":"13px",cursor:"w-resize"},onClick:s[1]||(s[1]=N=>r.adjustRange("left"))},U(e.range.value[0])+U(t.item.rangeSuffix),1),J(T,{disabled:e.range.disabled,dragOnClick:!0,adsorb:!0,lazy:!0,hideLabel:!0,included:!!e.range.marks,interval:e.range.min===e.range.max?1:t.item.rangeInterval||1,marks:e.range.marks,modelValue:e.range.value,min:e.range.min,max:e.range.max,"min-range":e.range.min===e.range.max?0:t.item.rangeMinDist||0,"enable-cross":!1,onChange:r.rangeChanged,"tooltip-formatter":t.item.tooltipFormatter||r.tooltipFormatter,"tooltip-placement":"top",tooltip:"active","use-keyboard":!1,onDragStart:s[2]||(s[2]=N=>e.$store.commit("prop",{key:"searchOptCloseGuard",value:!0})),onDragEnd:s[3]||(s[3]=N=>e.$store.commit("prop",{key:"searchOptCloseGuard",value:!1}))},null,8,["disabled","included","interval","marks","modelValue","min","max","min-range","onChange","tooltip-formatter"]),g("span",{style:{"font-size":"13px","line-height":"13px",cursor:"e-resize"},onClick:s[4]||(s[4]=N=>r.adjustRange("right"))},U(e.range.value[1])+U(t.item.rangeSuffix),1)])):k("",!0),t.item.dropdownOpts?(p(),m("div",xs,[J(B,{ref:"multiselect",value:t.item.value,placeholder:t.item.placeholder||"Include...",onChange:r.dropdownChanged,onOpen:r.dropdownOpened,options:e.dropdownOptions,mode:"tags",hideSelected:!0,clearOnSelect:!1,closeOnSelect:!1,multiple:!0,taggable:!0,searchable:!0,"track-by":t.item.dropdownTrackBy,label:t.item.dropdownLabel,valueProp:t.item.dropdownValueProp},null,8,["value","placeholder","onChange","onOpen","options","track-by","label","valueProp"])])):k("",!0)],10,js)),[[E,{delay:150,maxWidth:350,placement:t.tippyTop?"top":"left",flipBehavior:t.tippyTop?["top","bottom","left","right"]:["left","top","bottom","right"],distance:t.listName?20:10}]]):k("",!0)])}var Ys=Ce(Vs,[["render",Xs],["__scopeId","data-v-197c530e"]]);const ea={viewBox:"0 0 512 512",width:"1.2em",height:"1.2em"},ta=g("path",{fill:"currentColor",d:"M256.455 8c66.269.119 126.437 26.233 170.859 68.685l35.715-35.715C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.75c-30.864-28.899-70.801-44.907-113.23-45.273c-92.398-.798-170.283 73.977-169.484 169.442C88.764 348.009 162.184 424 256 424c41.127 0 79.997-14.678 110.629-41.556c4.743-4.161 11.906-3.908 16.368.553l39.662 39.662c4.872 4.872 4.631 12.815-.482 17.433C378.202 479.813 319.926 504 256 504C119.034 504 8.001 392.967 8 256.002C7.999 119.193 119.646 7.755 256.455 8z"},null,-1),sa=[ta];function aa(e,s){return p(),m("svg",ea,sa)}var na={name:"fa-solid-redo-alt",render:aa};const ia={name:"searchOptions",props:["listName"],data:function(){return{css:{arrow:{left:"0px"},options:{right:"0px"}}}},computed:{mainfilters(){const e=this.$route.name==="wishlist",s=this.$route.name==="series";return _.filter(this.optionsList,t=>t.type==="filter"&&(e?!t.excludeFromWishlist:!0)&&(s?!t.excludeFromSeriesSubPage:!0))},filteredOptionsList(){const e=this.$route.name==="wishlist",s=this.$route.name==="series",t=this.$store.state.sticky.viewMode!=="grid";return _.filter(this.optionsList,l=>{const i=l.key==="sortValues",r=l.type!=="filter";return!(t&&i)&&r&&(e?!l.excludeFromWishlist:!0)&&(s?!l.excludeFromSeriesSubPage:!0)})}},created:function(){this.$store.commit("prop",{key:"lazyScroll",value:!1}),this.$updateQueries({y:null}),this.optionsList=this.$store.state.listRenderingOpts[this.listName]},mounted:function(){this.repositionSearchOptions(),this.$compEmitter.on("repositionSearchOpts",this.repositionSearchOptions),this.$compEmitter.on("afterWindowResize",this.repositionSearchOptions)},beforeUnmount:function(){this.$compEmitter.off("repositionSearchOpts",this.repositionSearchOptions),this.$compEmitter.off("afterWindowResize",this.repositionSearchOptions),scroll({top:0,behavior:"smooth"}),this.$store.commit("prop",{key:"searchOptOpenHeight",value:null}),this.$store.commit("prop",{key:"lazyScroll",value:!0})},methods:{resetFilters:function(){this.$updateQueries({filter:null,filterExtras:null}),this.$store.commit("resetFilters"),this.$compEmitter.emit("start-filter")},repositionSearchOptions:_.debounce(function(){this.$nextTick(function(){const e={};e.el=this.$refs.options,e.width=e.el.offsetWidth,e.left=e.el.offsetLeft;const s={};s.el=document.querySelector("#ale-search > .icons"),s.width=s.el.offsetWidth;const t={};t.el=document.querySelector(".search-opt-btn.active").parentNode,t.width=t.el.offsetWidth,t.left=t.el.offsetLeft,t.middle=s.width-(t.left+t.width/2),e.position=t.middle-e.width/2;const l=t.el.getBoundingClientRect().left+t.width/2+e.width/2-window.innerWidth,i=l>0?l+20:0;this.css.options.right=e.position+i+"px",this.css.arrow.left=e.width/2-10+i+"px"})},150,{leading:!0,trailing:!1}),sortersMounted:_.debounce(function(){if(this.$refs.options){let e=this.$refs.options.offsetHeight+this.$refs.options.offsetTop;window.innerHeight>e?e=window.innerHeight:e=e+100,this.$store.commit("prop",{key:"searchOptOpenHeight",value:e})}},250,{leading:!1,trailing:!0})}},la={class:"search-options-inner-wrap"},ra={class:"total"};function oa(e,s,t,l,i,r){const n=na,u=Ys,y=Ge("tippy");return p(),m("div",{id:"search-options",ref:"options",class:S(t.listName+"-options"),style:je(e.css.options)},[g("div",la,[g("div",{class:"search-opts-arrow",style:je(e.css.arrow)},null,4),t.listName==="filter"&&e.$store.getters.regularFilters?(p(),m("ul",{key:0,class:"regular-filters",style:je({top:e.$store.state.topNavOffset+"px"})},[me((p(),m("li",{class:"reset-filters",onClick:s[0]||(s[0]=(...c)=>r.resetFilters&&r.resetFilters(...c)),content:"Reset filters"},[J(n)])),[[y,{placement:"top",flipBehavior:["top","right","bottom","left"]}]]),g("li",ra,[g("span",{class:S({difference:e.$store.getters.collection.length!==e.$store.getters.collectionTotal})},U(e.$store.getters.collection.length),3),He(" / "+U(e.$store.getters.collectionTotal),1)]),(p(!0),m(x,null,Y(r.mainfilters,(c,o)=>(p(),m("li",{class:"search-option",key:c.key},[J(u,{label:c.label,item:c,index:o,currentList:e.optionsList,listName:t.listName,onVnodeMounted:r.sortersMounted},null,8,["label","item","index","currentList","listName","onVnodeMounted"])]))),128))],4)):k("",!0),g("ul",null,[(p(!0),m(x,null,Y(r.filteredOptionsList,(c,o)=>(p(),m("li",{class:S(["search-option",{extras:c.type&&c.type.match(/extra/i),divider:c.type==="divider"}]),key:c.key},[c.type!=="divider"?(p(),$e(u,{key:0,label:c.label,item:c,index:o,currentList:e.optionsList,listName:t.listName,onVnodeMounted:r.sortersMounted},null,8,["label","item","index","currentList","listName","onVnodeMounted"])):k("",!0)],2))),128))])])],6)}var ua=Ce(ia,[["render",oa]]);const ca={name:"searchIcons",props:["listName"],data:function(){return{items:[{name:"scope",on:!0,active:!1,icon:"fa-solid fa-microscope",tooltip:"Change the search scope for more accurate results"},{name:"filter",on:!0,active:!1,icon:"fa-solid fa-filter",tooltip:"Filter books"},{name:"sort",on:!0,active:!1,icon:"fa-solid fa-sort",tooltip:"Sort books"}]}},computed:{filtersActive:function(){return this.$store.getters.filterExtrasKeys||this.$store.getters.filterKeys!=="notStarted,started,finished"&&this.$store.getters.filterKeysLength},filteredItems(){return _.filter(this.items,e=>this.showIcon(e))}},methods:{openSearchOptions:function(e,s){const t=this.listName;this.$emit("update:listName",!1),t!==e.name&&this.$nextTick(function(){this.$emit("update:listName",e.name)})},showIcon:function(e){if(!!e)switch(e.name){case"scope":return this.$store.state.listRenderingOpts[e.name].length>0;case"filter":let s=!this.$store.getters.regularFilters;return _.filter(this.$store.state.listRenderingOpts[e.name],function(t){let l=t.type==="divider",i=s?!0:t.type===e.name;return!l&&i}).length>0;case"sort":return _.filter(this.$store.state.listRenderingOpts[e.name],function(t){let l=t.type==="divider",i=t.type===e.name;return!l&&i}).length>0}}}},da={class:"icons"},fa=["content"],ha={class:"book-in-selection"},va={class:"inner-wrap"},pa=["content","onClick"],ma=["data-option"];function ga(e,s,t,l,i,r){const n=Ge("tippy");return p(),m("div",da,[me((p(),m("div",{class:"icon-wrap",content:"Items in current selection: <strong>"+e.$store.getters.collection.length+"</strong> / <strong>"+e.$store.getters.collectionTotal+"</strong>"},[g("div",ha,[g("div",va,U(e.$store.getters.collection.length),1)])],8,fa)),[[n]]),(p(!0),m(x,null,Y(r.filteredItems,u=>me((p(),m("div",{key:u.name,class:S(["icon-wrap",{disabled:!u.on}]),content:u.tooltip,onClick:y=>r.openSearchOptions(u,y)},[g("div",{class:S(["search-opt-btn",{active:t.listName===u.name,"active-filters":u.name==="filter"&&r.filtersActive}]),"data-option":u.name},[g("i",{class:S(u.icon)},null,2)],10,ma)],10,pa)),[[n]])),128))])}var ya=Ce(ca,[["render",ga],["__scopeId","data-v-67668a0c"]]),ba={methods:{sortName:function(e){return _.orderBy(e.books,function(s){if(s.name)return s.name},e.direction)}}},ka={methods:{sortIsbns:function(e){return _.orderBy(e.books,function(s){if(s.isbns){if(e.sortKey==="isbn10"){const t=_.find(s.isbns,["type","ISBN_10"]);return t?""+t.identifier:null}else if(e.sortKey==="isbn13"){const t=_.find(s.isbns,["type","ISBN_13"]);return t?""+t.identifier:null}}else return null},e.direction)}}},Oa={methods:{sortTitle:function(e){return _.orderBy(e.books,[function(s){const t=s[e.sortKey];return t?e.sortKey==="title"?s.title||s.titleShort:_.isArray(t)&&_.find(t,"name")?_.map(t,"name").join(", "):t:null}],e.direction)}}},Sa={methods:{sortAmount:function(e){return _.orderBy(e.books,function(s){if(e.sortKey==="amountTotal"){if(s.allBooksMinusDupes)return s.allBooksMinusDupes.length;if(s.allBooks)return s.allBooks.length}else if(s.books)return s.books.length},e.direction)}}},_a={mixins:[nt],methods:{sortLength:function(e){const s=this;return _.orderBy(e.books,function(t){return t.length?s.timeStringToSeconds(t.length):0},e.direction)}}},wa={methods:{sortRatings:function(e){const s=e.sortKey,t=[],l=[e.direction];switch(t.push(function(i){const r=_.get(i,s,0);return Number(r)}),s){case"myRating":case"rating":t.push(function(i){const r=_.get(i,"ratings",0);return Number(r)}),l.push(e.direction);break;case"ratings":t.push(function(i){const r=_.get(i,"rating",0);return Number(r)}),l.push(e.direction);break}return _.orderBy(e.books,t,l)}}},La={methods:{sortByLength:function(e){return _.orderBy(e.books,function(s){if(e.sortKey==="narratorsNumber")if(s.narrators){let t=_.find(s.narrators,function(l){return l.name.match("full cast")});return t&&s.narrators.length===1?99999999:s.narrators.length-(t?1:0)}else return 0;else return s[e.sortKey].length||0},e.direction)}}},$a={mixins:[nt],methods:{sortProgress:function(e){var s=this;return _.orderBy(e.books,[function(t){if(t.progress){if(t.progress.toLowerCase().trim()==="finished")return 100;if(t.length){var l=s.timeStringToSeconds(t.progress);const i=s.timeStringToSeconds(t.length);return l=i-l,l/i*100}else return 0}else return 0},function(t){return t.length?!s.timeStringToSeconds(t.length):0}],e.direction)}}},Ca={methods:{sortDateAdded:function(e){return _.orderBy(e.books,function(s){return s.added},e.direction)}}},Ta={methods:{sortFavorites:function(e){return _.orderBy(e.books,function(s){return s.favorite},e.direction)}}},Ia={methods:{sortWhispersync:function(e){return _.orderBy(e.books,function(s){const t=s[e.sortKey];if(t){if(t==="owned")return 2;if(t==="available")return 1}else return 0},e.direction)}}},Ba={methods:{sortBookNumbers:function(e){return _.orderBy(e.books,function(s){return s.added},e.direction)},sortBookNumbersOriginal:function(e){const s=this.$route.params.series;return _.orderBy(e.books,function(t){let l=function(i){(_.isEmpty(i)||!i)&&(i=void 0);const r=_.isArray(i)?i[0]:i,n=typeof r=="string"?r.split("-"):[r];return n[0]?parseFloat(n[0]):n[0]};if(s&&t.series){let i=_.find(t.series,{asin:s});return l(i.bookNumbers)}else if(_.find(t.series,"bookNumbers")){let r=_.filter(t.series,"bookNumbers");return r=_.map(r,"bookNumbers"),r=_.flatten(r),l(r)}else return _.find(t.series)?-1:-2},e.direction)}}},Pa={methods:{sortReleaseDate:function(e){return _.orderBy(e.books,function(s){return s.releaseDate?new Date(s.releaseDate.split("-").join("/")):0},e.direction)}}},Ea={methods:{sortStringNameProp:function(e){const s=e.sortKey.replace(".name","");return _.orderBy(e.books,function(t){return t[s]?t[s][0].name.toLowerCase():null},e.direction)}}},Na={methods:{sortMissing:function(e){return _.orderBy(e.books,[s=>s.allBooksMinusDupes?s.allBooksMinusDupes.length-s.books.length:s.allBooks?s.allBooks.length-s.books.length:0,s=>s.myRating],[e.direction,"desc"])}}},Ra={mixins:[ba,ka,Oa,Sa,_a,wa,$a,La,Ca,Ta,Ia,Ba,Pa,Ea,Na],methods:{filterBooks:function(e){const s=_.filter(this.$store.state.listRenderingOpts.filter,{type:"filter",active:!0}),t=_.find(this.$store.state.listRenderingOpts.filter,{type:"filter"}),l=_.filter(this.$store.state.listRenderingOpts.filter,{type:"filterExtras",active:!0});if(s||l){let i=function(r){let n=_.map(s,function(y){return!!y.condition(r)}),u=_.map(l,function(y){return!!y.condition(r)});return(t?_.includes(n,!0):!0)&&!_.includes(u,!1)};return _.filter(e,i)}else return e},sortBooks:function(e){const s=_.find(this.$store.state.listRenderingOpts.sort,function(t){if(t.key==="randomize"&&t.active)return!0;if(t.current)return!0});if(s){const t={books:e,direction:s.active?"desc":"asc",sortKey:s.key};switch(t.sortKey){case"randomize":e=_.shuffle(e);break;case"bookNumbers":t.missingNumber=0,e=this.sortBookNumbersOriginal(t);break;case"seriesOrder":t.missingNumber=0,e=this.sortBookNumbers(t);break;case"added":e=this.sortDateAdded(t);break;case"releaseDate":e=this.sortReleaseDate(t);break;case"authors.name":case"narrators.name":case"publishers.name":case"categories":case"tags.name":e=this.sortStringNameProp(t);break;case"narratorsNumber":e=this.sortByLength(t);break;case"title":case"series":case"format":case"isNew":case"language":case"fromPlusCatalog":case"unavailable":case"favorite":case"downloaded":case"storePageMissing":case"storePageChanged":case"archived":e=this.sortTitle(t);break;case"whispersync":e=this.sortWhispersync(t);break;case"length":e=this.sortLength(t);break;case"myRating":case"rating":case"ratings":e=this.sortRatings(t);break;case"progress":e=this.sortProgress(t);break;case"favorite":e=this.sortFavorites(t);break;case"name":e=this.sortName(t);break;case"amount":case"amountTotal":e=this.sortAmount(t);break;case"isbn10":case"isbn13":e=this.sortIsbns(t);break;case"missing":e=this.sortMissing(t);break}}return e}}};const qa={name:"GallerySearch",mixins:[Ra],props:["collectionSource"],data:function(){return{enableZoomTimer:null,fuse:null,fuseOptions:{keys:[],location:0,threshold:.3,ignoreLocation:!0,shouldSort:!0,includeScore:!0,includeMatches:!0,useExtendedSearch:!0,minMatchCharLength:2},listName:!1,waypointOpts:{rootMargin:"-37px"},fixedSearch:!1,highlightSearch:!1,readyToCloseOpts:!1,autocompleteResults:[],useAutocomplete:!1}},mounted:function(){if(this.$route.query.search){const t=decodeURIComponent(this.$route.query.search);this.$store.commit("prop",{key:"searchQuery",value:t})}this.$store.commit("prop",{key:"collectionSource",value:this.collectionSource});const e=this.$route.query.sort||this.$route.query.filter||this.$route.query.filterExtras;let s=_.get(this.$store.state,this.collectionSource);e?((this.$route.query.filter||this.$route.query.filterExtras)&&(s=this.filterBooks(s)),this.$route.query.sort&&(s=this.sortBooks(s)),this.$store.commit("prop",{key:"mutatingCollection",value:s})):this.$store.commit("prop",{key:"mutatingCollection",value:this.sortBooks(this.filterBooks(s))}),this.$route.query.search&&(this.$route.query.sort&&(this.fuseOptions.shouldSort=!1),this.search(this.$event,"on-load")),this.$refs.aleSearch.addEventListener("touchstart",this.iosAutozoomDisable,{passive:!0}),this.$compEmitter.on("ios-auto-zoom-disable",this.iosAutozoomDisable),this.$compEmitter.on("start-scope",this.scope),this.$compEmitter.on("start-sort",this.sort),this.$compEmitter.on("start-filter",this.filter),this.$compEmitter.on("search-focus",this.focusOnSearch),this.$store.commit("prop",{key:"searchMounted",value:!0})},beforeUnmount:function(){this.$store.commit("prop",{key:"searchQuery",value:""}),this.$refs.aleSearch.removeEventListener("touchstart",this.iosAutozoomDisable),this.$compEmitter.off("ios-auto-zoom-disable",this.iosAutozoomDisable),this.$compEmitter.off("start-scope",this.scope),this.$compEmitter.off("start-sort",this.sort),this.$compEmitter.off("start-filter",this.filter),this.$compEmitter.off("search-focus",this.focusOnSearch),this.$store.commit("prop",{key:"searchMounted",value:!1})},methods:{dontCloseOpts:_.throttle(function(){this.readyToCloseOpts&&(this.readyToCloseOpts=!1)},50,{leading:!1,trailing:!0}),closeOpts:function(){this.readyToCloseOpts&&(this.readyToCloseOpts=!1,this.$nextTick(function(){let e=this;setTimeout(function(){e.listName=!1},30)}))},scope:function(){this.$nextTick(()=>{this.$store.getters.searchIsActive&&(this.$store.commit("prop",{key:"mutatingCollection",value:this.sortBooks(this.filterBooks(_.get(this.$store.state,this.collectionSource)))}),this.$store.getters.searchIsActive||(this.fuseOptions.shouldSort=!1),this.search())})},filter:function(){this.$nextTick(()=>{this.$store.commit("prop",{key:"mutatingCollection",value:this.sortBooks(this.filterBooks(_.get(this.$store.state,this.collectionSource)))}),this.$store.getters.searchIsActive||(this.fuseOptions.shouldSort=!1),this.$store.getters.searchIsActive&&this.search()})},sort:function(){this.$nextTick(()=>{this.$store.commit("prop",{key:this.$store.getters.searchIsActive?"searchCollection":"mutatingCollection",value:this.sortBooks(this.$store.getters.collection)})})},search:_.debounce(function(e,s){const t={};if(decodeURIComponent(this.$route.query.search),s||(t.book=null,this.$store.commit("prop",{key:"bookClicked",value:!0})),e)if(this.fuseOptions.shouldSort=!0,this.$store.commit("prop",{key:"searchQuery",value:e.target.value}),t.search=encodeURIComponent(e.target.value),e.target.value.trim()!=="")this.$route.query.sort&&(t.sort=null,t.sortDir=null);else{var i=_.find(this.$store.state.listRenderingOpts.sort,"current");t.sort=i.key,t.sortDir=i.active?"desc":"asc"}if(this.$updateQueries(t),this.$store.getters.searchIsActive){const r=this.modifyQuery(this.$store.state.searchQuery);this.fuseOptions.keys=this.aliciaKeys;let n=this;n.fuse=new Pt(n.$store.state.mutatingCollection,n.fuseOptions);let u=n.fuse.search(r);n.useAutocomplete&&n.autocomplete(u),u=_.map(u,"item"),n.$store.commit("prop",{key:"searchCollection",value:u})}else this.$store.commit("prop",{key:"searchCollection",value:[]})},270,{leading:!1,trailing:!0}),autocomplete:function(e){let s=_.map(JSON.parse(JSON.stringify(this.aliciaKeys)),function(t,l){return t.key=t.name,t.name=t.name.replace(".name",""),t.active=l<1,t});_.each(e,function(t){_.each(t.matches,function(l){const i=_.find(s,{key:l.key});i.books=i.books||[],i.books.push({item:t.item,match:l,refIndex:t.refIndex,score:t.score})})}),s=_.filter(s,"books"),_.each(s,function(t,l){t.books=_.uniqBy(t.books,"match.value"),t.books=t.books.slice(0,5),t.books.length<2&&(s[l]=null),t.active=!1}),s=_.compact(s),s.length&&(s[0].active=!0),console.log("sections",s),this.autocompleteResults=s,console.log(s)},active_ac_item:function(e){_.each(this.autocompleteResults,function(s){s.active=!1}),e.active=!0},searchAutocompleteResult:function(e){const s=e.match.value;this.$store.commit("prop",{key:"searchQuery",value:`"${s}"`}),this.search()},searchEnterBlur:_.debounce(function(e){this.$refs.searchInput.blur()},100,{leading:!1,trailing:!0}),restoreOptions:function(){updateListRenderingOpts()},focusOnSearch:function(){scroll({top:0}),this.$refs.searchInput.focus()},modifyQuery:function(e){let s=e;return(e.match(/&/i)||e.match(/ and /i)||e.match(/ a /i)||e.match(/ the /i))&&(s=e+"|"+e.replace(/ & /ig," ")+"|"+e.replace(/ and /ig," ")+"|"+e.replace(/ a /ig," ")+"|"+e.replace(/ an /ig," ")+"|"+e.replace(/ the /ig," ")),s},iosAutozoomDisable:function(){if(document.querySelector(".is-ios")){let s=document.querySelector("head").querySelector("meta[name=viewport]");s.content="width=device-width, initial-scale=1.0, user-scalable=0",clearTimeout(this.enableZoomTimer),this.enableZoomTimer=setTimeout(function(){s.content="width=device-width, initial-scale=1.0, user-scalable=1"},700)}}},computed:{aliciaKeys:function(){const e=_.filter(this.$store.state.listRenderingOpts.scope,["active",!0]);return _.map(e,function(s){return{name:s.key,weight:s.weight||0}})},placeholder:function(){const e=function(s){return _.map(s,function(t){return t.name.replace(".name","")}).join(", ")}(this.aliciaKeys);return"Search: "+e}}},Aa={id:"ale-search",ref:"aleSearch"},Da=["value","placeholder"],Ma={key:1,class:"autocomplete"},Ka={class:"header-wrapper"},Va=g("div",{class:"title"},"Autocomplete: ",-1),Fa=["onClick"],ja={class:"content"},za=["onClick"];function Ha(e,s,t,l,i,r){const n=Bt,u=It,y=ya,c=ua,o=$t;return p(),m("div",null,[J(n),e.$route.meta.subPage?(p(),$e(u,{key:0,aboveSearch:!0})):k("",!0),g("div",{id:"ale-search-wrap",ref:"searchWrap",class:S({"search-fixed":e.fixedSearch,"highlight-search":e.highlightSearch})},[me(g("div",{id:"search-dropdown-overlay",onMousedown:s[0]||(s[0]=v=>e.readyToCloseOpts=!0),onTouchstart:s[1]||(s[1]=v=>e.readyToCloseOpts=!0),onTouchmove:s[2]||(s[2]=(...v)=>r.dontCloseOpts&&r.dontCloseOpts(...v)),onClick:s[3]||(s[3]=(...v)=>r.closeOpts&&r.closeOpts(...v))},null,544),[[Tt,e.listName]]),g("div",Aa,[g("div",{class:"search-wrapper",onClick:s[7]||(s[7]=v=>e.$refs.searchInput.focus())},[g("input",{type:"search",ref:"searchInput",value:e.$store.state.searchQuery,onInput:s[4]||(s[4]=(...v)=>r.search&&r.search(...v)),onKeyup:s[5]||(s[5]=ze((...v)=>r.searchEnterBlur&&r.searchEnterBlur(...v),["enter"])),placeholder:r.placeholder,onFocus:s[6]||(s[6]=v=>e.listName=!1)},null,40,Da)]),J(y,{"list-name":e.listName,"onUpdate:list-name":s[8]||(s[8]=v=>e.listName=v)},null,8,["list-name"]),e.listName?(p(),$e(c,{key:0,"list-name":e.listName,"onUpdate:list-name":s[9]||(s[9]=v=>e.listName=v)},null,8,["list-name"])):k("",!0)],512),e.$route.meta.gallery&&e.$store.state.windowWidth>=450?(p(),$e(o,{key:0})):k("",!0)],2),e.useAutocomplete&&e.autocompleteResults&&e.autocompleteResults.length?(p(),m("div",Ma,[g("div",Ka,[Va,(p(!0),m(x,null,Y(e.autocompleteResults,v=>(p(),m("div",{class:S(["header",{active:v.active}]),key:v.key+"-header",onClick:T=>r.active_ac_item(v)},[g("div",null,U(v.name),1)],10,Fa))),128))]),e.item.active?(p(!0),m(x,{key:0},Y(e.autocompleteResults,v=>(p(),m("div",{class:"content-wrapper",key:v.key},[g("div",ja,[(p(!0),m(x,null,Y(v.books,T=>(p(),m("div",{onClick:B=>r.searchAutocompleteResult(T)},[g("span",null,U(T.match.value),1)],8,za))),256))])]))),128)):k("",!0)])):k("",!0)])}var Ja=Ce(qa,[["render",Ha]]);export{Ys as _,Ja as a};
