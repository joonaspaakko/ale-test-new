var m={methods:{shortenLength:function(e){if(e)if(e=DOMPurify.sanitize(e.trimToColon().trimAll()),e.match(/\d/)){const r=this.timeStringToSeconds(e);return this.secondsToTimeString(r,!0)}else return null;else return null},getSummary:function(e){e.removeAttribute("class");var r=e.querySelectorAll("*");return $.each(r,function(){this.removeAttribute("class")}),DOMPurify.sanitize(e.outerHTML.trimAll())},fixDates:function(e){var r=typeof e=="object"?DOMPurify.sanitize(e.textContent.trimToColon()):DOMPurify.sanitize(e);if(e&&r){const t=this.domainExtension,n={".com":["m-d-y","MM-dd-yyyy"],".ca":["y-m-d","yyyy-MM-dd"],".co.uk":["d-m-y","dd-MM-yyyy"],".de":["d-m-y","dd-MM-yyyy"],".fr":["d-m-y","dd-MM-yyyy"],".it":["d-m-y","dd-MM-yyyy"],".com.au":["d-m-y","dd-MM-yyyy"],".in":["d-m-y","dd-MM-yyyy"]},c=n[t]?n[t][0]:null;let s=r.split("-");if(!c||!r.match(/\-/)||s.length!==3)return r;{const u=c.split("-"),i={y:null,m:null,d:null};$.each(s,function(h,o){i[u[h]]=o}),r=null,i.y.length<=2&&(i.y>=95&&i.y<=99?i.y="19"+i.y:i.y<95&&(i.y="20"+i.y));const a=[i.y,i.m,i.d];return dateFormat(new Date(a[0],a[1]-1,a[2]),"yyyy-MM-dd")}}else return null},getSeries:function(e,r){const t=[];if(e){var n=DOMPurify.sanitize($(e).html()).trimAll().trimToColon();n=$.parseHTML(n);const s=_.filter(n,function(u){var i=u.textContent.trim().replace(/^,/,"")||"";if(i)return u});$.each(s,function(u,i){var a=i.textContent.trim().replace(/^,/,"").trimAll()||"",h=(u+1)%2,o=!h;if(h){let l=new Url(i.href);t.push({name:a,asin:r?l.query.asin:l.path.substring(l.path.lastIndexOf("/")+1)})}else if(o&&a.match(/\d/)){var f=a.replace(/^[^0-9]*/,"").replace(/,$/,"").replace(/;$/,"").trim().split(","),y=t[t.length-1];y.bookNumbers=$.map(f,function(l){return""+l})}})}return t.length>0?r?t.reverse():t:null},getArray:function(e){const r=[];return $(e).each(function(){const n=new Url(DOMPurify.sanitize($(this).attr("href")),!0);let c,s,u;n.query.searchAuthor&&(c=n.query.searchAuthor),n.query.searchNarrator&&(s=n.query.searchNarrator),n.query.searchProvider&&(u=n.query.searchProvider),n.clearQuery(),c&&(n.query.searchAuthor=c),s&&(n.query.searchNarrator=s),u&&(n.query.searchProvider=u),s=null,u=null;let i={name:DOMPurify.sanitize($(this).text().trim())};const a=t(n.toString());a&&(i.url=a),r.push(i)}),r.length>0?r:null;function t(n){return n.match(/^\/cat\//)||n.match(/^\/author\//)?n.substring(n.lastIndexOf("/")+1):n.match(/^\/search\?searchAuthor/)||n.match(/^\/search\?searchNarrator/)||n.match(/^\/search\?searchProvider/)?null:n}},addedOrder:function(e){let r=e.length+1;_.each(e,function(t){--r,t.added=r})},makeFrenchFries:function(e){e.extras=e.extras||{},e.extras["domain-extension"]=e.extras["domain-extension"]||this.domainExtension,e.chunks=[],_.each(e,function(r,t){if(t!=="chunks"&&_.isArray(r)){const n=_.chunk(r,50);e.chunks.push(t),e[t+"-chunk-length"]=n.length,_.each(n,function(c,s){e[t+"-chunk-"+s]=c}),delete e[t]}})},glueFriesBackTogether:function(e){if(e&&_.isEmpty(e))return null;_.each(e.chunks,function(r){const t=e[r+"-chunk-length"],n=_.range(0,t);e[r]=[],_.each(n,function(c){e[r]=e[r].concat(e[r+"-chunk-"+c]),delete e[r+"-chunk-"+c]}),delete e[r+"-chunk-length"]}),delete e.chunks},removeFromSeries:function(e,r){_.each(r,function(t){t.series&&_.each(t.series,function(n){let c=_.find(e,{asin:n.asin});_.remove(c.books,function(s){return s===t.asin}),c.books.length<1&&_.remove(e,function(s){return s.asin===n.asin})})})},removeFromCollections:function(e,r){e=_.compact(e),_.each(e,function(t){t.books.length>0&&_.each(r,function(n){_.includes(t.books,n.asin)&&_.remove(t.books,function(s){return s===n.asin}),t.books.length<1&&_.remove(e,function(s){return s.id===t.id})})})}}};export{m as h};
