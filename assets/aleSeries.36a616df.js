import{_ as x}from"./lazy.a7ecd507.js";import{a as B}from"./aleSearch.eef7eabf.js";import{f as M}from"./findSubPageSource.4e06428f.js";import{_ as D,c as g,b,a as f,F as N,k as w,g as k,d as h,j as R,r as F,o as m,e as T,l as v,t as y,i as O,n as $}from"./vendor.c9fc1405.js";import"./gallery.d7c4eeb7.js";import"./makeCoverUrl.f6649fcf.js";/* empty css              */import"./helpers.c1b1b2ae.js";import"./page-title.ea8d61bb.js";import"./timeStringToSeconds.340b6df7.js";const P={name:"aleSeries",mixins:[M],data:function(){return{collectionSource:"pageCollection",pageTitle:"Series",pageSubTitle:null,listReady:!1}},computed:{optionsOpenMargin:function(){return this.$store.state.searchOptOpenHeight?{marginBottom:0}:!1},galleryStyle:function(){return this.$store.state.searchOptOpenHeight?{overflow:"hidden",height:this.$store.state.searchOptOpenHeight-this.$refs.wrapper.offsetTop*2+"px"}:!1}},methods:{makeCollection:function(){const i=this;let t=[],e=1,r=this.$store.state.library.series;_.eachRight(i.subPageSource.collection,function(s){s.series&&_.each(s.series,function(a){const n=_.find(t,{asin:a.asin});let l=r?_.find(r,{asin:a.asin}):!1,d,c,o;if(n)n.books.push(s.title||s.shortTitle),i.subPageSource.library&&(n.minRating=_.min([n.minRating,s.myRating].map(_.toNumber).filter(u=>!_.isNaN(u))),n.allBooksMinusDupes=l.allBooksMinusDupes,n.missingLatest=o!==c);else{i.subPageSource.library&&(l.allBooksMinusDupes=i.removeDuplicates(l.allBooks),d=l.allBooksMinusDupes.filter(p=>l.books.some(S=>S===p.asin)),c=_.max(l.allBooksMinusDupes.map(p=>_.toNumber(p.bookNumbers))),o=_.max(d.map(p=>_.toNumber(p.bookNumbers))));const u={name:a.name,asin:a.asin,added:e,books:[s.title||s.shortTitle],authors:s.authors,narrators:s.narrators,publishers:s.publishers};i.subPageSource.library&&!!l?(++e,u.minRating=_.toNumber(s.myRating),u.allBooksMinusDupes=l.allBooksMinusDupes,u.missingLatest=o!==c,t.push(u)):i.subPageSource.wishlist&&(++e,t.push(u))}})}),_.reverse(t),this.$store.commit("prop",{key:"pageCollection",value:t}),this.updateListRenderingOptions(),this.listReady=!0},updateListRenderingOptions:function(){let i=this,t={scope:[{active:!0,key:"name",tippy:"Search series by name",weight:5},{active:!0,key:"books",tippy:"Search series by book titles",weight:1},{active:!0,key:"authors.name",tippy:"Search series by authors",weight:1},{active:!0,key:"narrators.name",tippy:"Search series by narrators",weight:1},{active:!0,key:"publishers.name",tippy:"Search series by publishers",weight:1}],filter:[{active:!1,type:"filterExtras",label:"Number of books",key:"inSeries",range:[1,function(){let e=_.get(i.$store.state,i.collectionSource),r=_.maxBy(e,function(s){if(s.books)return s.books.length});return r?r.books.length:1}()],rangeMinDist:0,rangeSuffix:"",rangeMin:function(){return 1},rangeMax:function(){let e=_.get(i.$store.state,i.collectionSource),r=_.maxBy(e,function(s){if(s.books)return s.books.length});return r?r.books.length:1},condition:function(e){if(e.books){let r=this.range[0],s=this.range[1];return e.books.length>=r&&e.books.length<=s}}},{excludeFromWishlist:!0,type:"divider",key:"divider1.0"},{excludeFromWishlist:!0,active:!1,type:"filterExtras",label:"Rating (min)",tippy:"Based on the book you rated lowest in the series",key:"min-rating",condition:function(e){return(e.minRating||0)>=this.range[0]},range:!0,rangeMin:()=>1,rangeMax:()=>5,rangeMinDist:0,rangeSuffix:"",tooltipFormatter:function(e){switch(e){case 1:return e+" (Not for me)";case 2:return e+" (It\u2019s okay)";case 3:return e+" (Pretty good)";case 4:return e+" (It\u2019s great)";case 5:return e+" (I love it)";default:return 0}}},{excludeFromWishlist:!0,type:"divider",key:"divider1.1"},{excludeFromWishlist:!0,active:!1,type:"filterExtras",label:"Incomplete series",key:"series-incomplete",tippy:"Series where I don't own all the books",condition:function(e){return e.allBooksMinusDupes.length>e.books.length}},{excludeFromWishlist:!0,type:"divider",key:"divider1.2"},{excludeFromWishlist:!0,active:!1,type:"filterExtras",label:"Missing latest book",key:"missing-latest",condition:function(e){return e.missingLatest&&e.allBooksMinusDupes.length>e.books.length}}],sort:[{active:!1,key:"randomize",label:"Randomize",type:"sortExtras",tippy:"Ignores sorting and randomizes instead unless there's an active search."},{type:"divider",key:"divider1"},{active:!0,current:!0,key:"added",label:"Added",type:"sort",tippy:'<div style="text-align: left;"><small>&#9650;</small> Old at the top <br><small style="display: inline-block; transform: rotate(180deg);">&#9650;</small> New at the top</div>'},{active:!0,current:!1,key:"name",label:"Name",type:"sort",tippy:"Sort by series name"},{active:!1,current:!1,key:"amount",label:"Number of books",type:"sort"},{excludeFromWishlist:!0,active:!1,current:!1,key:"amountTotal",label:"Total number of books",type:"sort"},{excludeFromWishlist:!0,active:!1,current:!1,key:"missing",label:"Missing",tippy:"Number of missing books",type:"sort"}]};this.subPageSource.wishlist&&(t.filter=_.filter(t.filter,function(e){return!e.excludeFromWishlist}),t.sort=_.filter(t.sort,function(e){return!e.excludeFromWishlist})),this.$setListRenderingOpts(t)},removeDuplicates:function(i){let t=_.clone(i);var e=0;return _.each(t,function(r){r.order=++e}),t=_.groupBy(t,"bookNumbers"),_.each(t,function(r,s){if(r.length===1)t[s]=[r[0]];else{var a=_.filter(r,function(n){return!n.notInLibrary});a.length>0?t[s]=a:t[s]=[r[0]]}}),t=_.map(t,function(r){return r}),t=_.flatten(t),t=_.orderBy(t,"order","asc"),t}}},W={key:0,class:"books-total",content:"Total number of books I have in this series."},C={key:0};function I(i,t,e,r,s,a){const n=B,l=R("router-link"),d=x,c=F("tippy");return i.listReady?(m(),g("div",{key:0,id:"ale-series",class:"box-layout-wrapper",style:k(a.optionsOpenMargin),ref:"wrapper"},[b(n,{collectionSource:i.collectionSource,pageTitle:i.pageTitle,pageSubTitle:i.pageSubTitle},null,8,["collectionSource","pageTitle","pageSubTitle"]),f("div",{style:k(a.galleryStyle),class:"page-content"},[(m(!0),g(N,null,w(i.$store.getters.collection,(o,u)=>(m(),T(d,{class:"single-box","data-asin":o.asin,key:"series:"+o.asin},{default:v(()=>[b(l,{to:{name:"series",params:{series:o.asin},query:{subPageSource:i.subPageSource.name}}},{default:v(()=>[f("h2",null,y(o.name),1),o.books&&o.books.length?O((m(),g("div",W,[f("span",{class:$({"my-books":o.allBooksMinusDupes&&o.allBooksMinusDupes.length})},y(o.books.length),3),o.allBooksMinusDupes&&o.allBooksMinusDupes.length?(m(),g("span",C,"\xA0of\xA0"+y(o.allBooksMinusDupes.length),1)):h("",!0)])),[[c,{placement:"right"}]]):h("",!0)]),_:2},1032,["to"])]),_:2},1032,["data-asin"]))),128))],4)],4)):h("",!0)}var K=D(P,[["render",I],["__scopeId","data-v-b30c5332"]]);export{K as default};
